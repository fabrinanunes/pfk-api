openapi: 3.0.0
info:
  version: 1.0.0
  title: PFK Airlines
  description: 'Programa de Formação Kapivara'
  
servers:
  # Added by API Auto Mocking Plugin
  - description: SwaggerHub API Auto Mocking
    #url: https://virtserver.swaggerhub.com/fabrinanunes/PFK/1.0.0
    url: http://159.89.228.175
    
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

paths:
  /admin/register:
    post:
      tags: 
        - Login & Register
      summary: Register a new Admin Client
      description: Register to Administration Dashboard
      operationId: postNewAdmin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: 
                - name
                - email
                - password
              properties:
                name:
                  type: string
                email:
                  type: string
                password:
                  type: string
          
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  user: 
                    type: object
                    properties:
                      name:
                        type: string
                      email:
                        type: string
                      _id:
                        type: string
                      createdAt:
                        type: string
                  token:
                    type: string
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string                   
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  
  /admin/login:
    post:
      tags: 
        - Login & Register
      summary: Admin Client Login
      description: Login to Administration Dashboard
      operationId: adminLogin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: 
                - email
                - password
              properties:
                email:
                  type: string
                password:
                  type: string
                  
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  user: 
                    type: object
                    properties:
                      _id:
                        type: string
                      name:
                        type: string
                      email:
                        type: string
                      createdAt:
                        type: string
                      __v:
                        type: number
                  token:
                    type: string
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

  /register:
    post:
      tags: 
        - Login & Register
      summary: Register a new Customer Client
      description: Register to Customer Dashboard
      operationId: postNewCustomer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: 
                - name
                - email
                - password
              properties:
                name:
                  type: string
                email:
                  type: string
                password:
                  type: string
          
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  user: 
                    type: object
                    properties:
                      name:
                        type: string
                      email:
                        type: string
                      _id:
                        type: string
                      createdAt:
                        type: string
                  token:
                    type: string
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  
  /login:
    post:
      tags: 
        - Login & Register
      summary: Customer Client Login
      description: Login to Customer Dashboard
      operationId: customerLogin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: 
                - email
                - password
              properties:
                email:
                  type: string
                password:
                  type: string
                  
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  user: 
                    type: object
                    properties:
                      _id:
                        type: string
                      name:
                        type: string
                      email:
                        type: string
                      createdAt:
                        type: string
                      __v:
                        type: number
                  token:
                    type: string
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

  /profile:
    get:
      security:
        - bearerAuth: []
      tags: 
        - Profile
      summary: Gets Customer Profile
      description: Customer Profile
      operationId: getProfile

      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  _id:
                    type: string
                  user:
                    type: string
                  name:
                    type: string
                  email:
                    type: string
                  cards:
                    type: array
                    items: 
                      type: string
                  flights:
                    type: array
                    items: 
                      type: string
                  __v:
                    type: number
        "400": 
          description: Bad Request
          content:
            application/json:
              schema:
                type: object 
                properties:
                  error: 
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

  /my-cards:
    get:
      security:
        - bearerAuth: []
      tags:
        - Profile
      summary: Gets Customer's cards
      description: List saved cards
      operationId: getCustomerCards
      
      responses:
        "200":
          description: Ok
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    _id:
                      type: string
                    user:
                      type: string
                    card:
                      type: string
                    last4CardNumber:
                      type: string
                    expirationMonth:
                      type: string
                    expirationYear:
                      type: string
                    __v:
                      type: number
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

  /postcode:
    post:
      security:
        - bearerAuth: []
      tags: 
        - Zip Code
      summary: Post Zip Code
      description: Post Code Automation
      operationId: postZipCode
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                cep:
                  type: string
      
      responses:
        "200":
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties:
                  bairro:
                    type: string
                  cep:
                    type: string
                  cidade:
                    type: string
                  complemento2:
                    type: string
                  end:
                    type: string
                  uf:
                    type: string
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

  /payments/credit-cards/tokenization:
    post:
      security:
        - bearerAuth: []
      tags: 
        - Finances
      summary: Credit Card Tokenization
      description: Card Tokenization
      operationId: tokenization	
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                creditCardHash:
                  type: string
      
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  creditCardId:
                    type: string
                  last4CardNumber:
                    type: string
                  expirationMonth:
                    type: string
                  expirationYear:
                    type: string
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  Status:
                    type: number
                    example: 400
                  error:
                    type: string
                  message:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string            
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  
  /flights:
    get:
      security:
        - bearerAuth: []
      tags: 
        - Flights
      summary: Gets Flights
      description: List Flights
      operationId: getFlights
      
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    _id:
                      type: string
                    flight:
                      type: string
                    departureAirport:
                      type: string
                    arrivalAirport:
                      type: string
                    depatureDate:
                      type: string
                    depatureTime:
                      type: string
                    arrivalDate:
                      type: string
                    arrivalTime:
                      type: string
                    amount:
                      type: string
                    __v:
                      type: number
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

    post:
      security:
        - bearerAuth: []
      tags: 
        - Flights
      summary: Post New Flight
      description: Add New Flight
      operationId: postNewFlight
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - flight
                - departureAirport
                - arrivalAirport
                - depatureDate
                - depatureTime
                - arrivalDate
                - arrivalTime
                - amount
              properties:
                flight:
                  type: string
                departureAirport:
                  type: string
                arrivalAirport:
                  type: string
                depatureDate:
                  type: string
                depatureTime:
                  type: string
                arrivalDate:
                  type: string
                arrivalTime:
                  type: string
                amount:
                  type: string
      
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  flight:
                    type: string
                  departureAirport:
                    type: string
                  arrivalAirport:
                    type: string
                  depatureDate:
                    type: string
                  depatureTime:
                    type: string
                  arrivalDate:
                    type: string
                  arrivalTime:
                    type: string
                  amount:
                    type: string
                  _id:
                    type: string
                  __v:
                    type: number
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string        
  
  /balance:
    get:
      security:
        - bearerAuth: []
      tags: 
        - Finances
      summary: Gets Balance
      description: Balance
      operationId: getFlights
      
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: number
                example: 4586.10
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

  /payments/refund:
    post:
      security:
        - bearerAuth: []
      tags: 
        - Solicitations
      summary: Refunds Customer's Payment
      description: Refund Request
      operationId: refundRequest
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: 
                - payment ID
                - amount
              properties:
                paymentId:
                  type: string
                amount:
                  type: string
      
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  user: 
                    type: string
                  paymentId:
                    type: string
                  amount:
                    type: string
                  name:
                    type: string
                  email:
                    type: string
                  _id:
                    type: string
                  __v:
                    type: number
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string            
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

  /admin/solicitation:
    get:
      security:
        - bearerAuth: []
      summary: Get Customer's Solicitations
      tags: 
        - Admin
      description: Check Customer's Solicitations
      operationId: getSolicitations
      
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    _id:
                      type: string
                    user:
                      type: string
                    paymentId:
                      type: string
                    amount:
                      type: string
                    name:
                      type: string
                    email:
                      type: string
                    __v:
                      type: number
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string            
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

  /profile/payments:
    get:
      security:
        - bearerAuth: []
      tags: 
        - Profile
      summary: Gets Customer's Purchase
      description: List Customer's Purchase	
      operationId: getPayments

      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  _id:
                    type: string
                  user:
                    type: string
                  chargeId:
                    type: string
                  flight:
                    type: string
                  v:
                    type: number
                  amount:
                    type: string
                  card:
                    type: string
                  paymentId:
                    type: string
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

  /payment:
    post:
      security:
        - bearerAuth: []
      tags: 
        - Finances
      summary: Post New Payment
      description: Add New Payment
      operationId: postPayment	
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: 
                - chargeId
                - email
                - street
                - number
                - city
                - state
                - postCode
                - creditCardId
              properties:
                chargeId:
                  type: string
                billing:
                  type: object
                  properties:
                    email:
                      type: string
                    address:
                      type: object
                      properties:
                        street:
                          type: string
                        number:
                          type: string
                        city:
                          type: string
                        state:
                          type: string
                        postCode:
                          type: string
                delayed: 
                  type: boolean
                creditCardDetails:
                  type: object
                  properties:
                    creditCardId:
                      type: string
      
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  chargeId:
                    type: string
                  date:
                    type: string
                  releaseDate:
                    type: string
                  amount:
                    type: number
                  fee:
                    type: number
                  type: 
                    type: string
                  status:
                    type: string
                  failReason:
                    type: string
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string 
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

  /admin/payment/refund/{id}:
    post:
      security:
        - bearerAuth: []
      tags: 
        - Finances
      summary: Refund Payment
      description: Refund a Payment	
      operationId: refund
      parameters:
      - name: id
        in: path
        required: true
        description: The payment ID to refund
        schema: 
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: 
                - amount
              properties:
                amount:
                  type: number
      
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  transactionId:
                    type: string
                  installments:
                    type: number
                    example: 1
                  payments:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        chargeId:
                          type: string
                        date:
                          type: string
                        releaseDate:
                          type: string
                        amount:
                          type: number
                        fee:
                          type: number
                        type: 
                          type: string
                        status:
                          type: string
                        failReason:
                          type: string
                  refunds:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        chargeId:
                          type: string
                        releaseDate:
                          type: string
                        paybackDate:
                          type: string
                        amount:
                          type: number
                        fee:
                          type: number
                        status:
                          type: string
                        transactionId:
                          type: string
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
 
  /charges:
    post:
      security:
        - bearerAuth: []
      tags: 
        - Finances
      summary: Post New Charge
      description: Create New Charge
      operationId: postCharge	
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: 
                - description
                - amount
                - paymentTypes
                - paymentAdvance
                - name
                - document
                - email
                - street
                - number
                - city
                - state
                - postCode
              properties:
                charge:
                  type: object
                  properties:
                    description: 
                      type: string
                    amount:
                       type: number
                    paymentTypes:
                      type: array
                      items:
                        type: string
                    paymentAdvance:
                      type: boolean
                billing:
                  type: object
                  properties:
                    name:
                      type: string
                    document:
                      type: string
                    email:
                      type: string
                    address:
                      type: object
                      properties:
                        street:
                          type: string
                        number:
                          type: string
                        city:
                          type: string
                        state:
                          type: string
                        postCode:
                          type: string
      
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  code:
                    type: number
                  reference:
                    type: string
                  dueDate:
                    type: string
                  checkoutUrl:
                    type: string
                  amount:
                    type: number
                  status:
                    type: string
                  _links:
                    type: object
                    properties:
                      self:
                        type: object
                        properties:
                          href:
                            type: string
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  Status:
                    type: number
                  Error:
                    type: string
                  Message:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string 
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

  /admin/charges:
    get:
      security:
        - bearerAuth: []
      tags: 
        - Finances
      summary: Gets all Charges
      description: List Charges
      operationId: getCharges

      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                    code:
                      type: number
                    references:
                      type: string
                    dueDate:
                      type: string
                    checkoutUrl:
                      type: string
                    amount:
                      type: number
                    status:
                      type: string
                    _links:
                      type: object
                      properties:
                        self:
                          type: object
                          properties:
                            href:
                              type: string
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  Status:
                    type: number
                  Error:
                    type: string
                  Message:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string             
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    
  /charges/{id}:
    get:
      security:
        - bearerAuth: []
      tags: 
        - Finances
      summary: Gets a Charge by ID
      description: Check Charge Status
      operationId: getChargeById
      parameters:
      - name: id
        in: path
        required: true
        description: The charge ID to check
        schema: 
          type: string
      
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  code:
                    type: number
                  reference:
                    type: string
                  dueDate:
                    type: string
                  checkoutUrl:
                    type: string
                  amount:
                    type: number
                  status:
                    type: string
                  payments:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        chargeId:
                          type: string
                        date:
                          type: string
                        releaseDate:
                          type: string
                        amount:
                          type: number
                        fee:
                          type: number
                        type: 
                          type: string
                        status:
                          type: string
                        failReason:
                          type: string
                  _links:
                    type: object
                    properties:
                      self:
                        type: object
                        properties:
                          href:
                            type: string
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  Status:
                    type: number
                  Error:
                    type: string
                  Message:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
